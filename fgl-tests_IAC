pipeline {
  agent any
  def rtGradle = Artifactory.newGradleBuild()
  parameters {
    choice (
      name: 'node',
      choices: ['node1', 'node2', 'node3'],
      description: "Choose Node"
    )

    stages {
        node (${node}) {
          stage('Checkout') {
            steps {
                git branch: 'develop', credentialsId: 'bitbucket.corp.ad.ctc', url: 'ssh://git@bitbucket.corp.ad.ctc:22/mdmdevops/auto.git'
            }
          }

          stage('Build') {
            rtGradle.tool = "Gradke 4.10.2"
            steps {
              rtGradle.run buildFile: 'build.gradle', tasks: '-i --continue -Dhost=test3 -Dbrowser=chrome runAllFglTests -DhighLightMarker=off'
              allure([includeProperties: false, jdk: '', results: [[path: 'build/allure-results']]])
            }
          }
        }

    }
  }
}
